# 后端接口设计规范

基本要求：接口基本逻辑正确、业务逻辑正确、request/response规范

（自己写完的接口：必须自己调试跑通、必须自己根据接口走一下业务流程）

### 一、接口符合restful风格

1、每一个URI代表1种资源

```
/api/app/models/
/api/app/models/model_id/
/api/app/models/model_id/filed_name/
/api/app/models/model_id/action/
/api/app/models/model_id/child_models/
/api/app/models/model_id/child_models/child_model_id/
```

2、客户端使用GET、POST、PUT、PATCH、DELETE请求方式对服务端资源进行操作

- ​	GET用来获取资源 
- POST用来新建资源（也可以用于更新资源），
- PUT用来更新资源；
- PATCH用来更新局部资源
- DELETE用来删除资源

3、参数规范

4、Response状态码

​	200、400、401、404、500

### 二、接口完整度

对于一个model应提供基本接口

- 获取对象列表
- 创建对象
- 获取对象详情
- 更新
- 更新对象局部信息
- 删除对象

```
可参考框架源码：from rest_framework.viewsets import ModelViewSet
```

### 三、接口设计降低耦合度

目的：接口设计的解耦合，可维护性、可用性高；前端功能设计可组件化处理

- 一个接口尽量只是操作1类资源：一个对象、或一类对象的列表
- 尽量避免一个接口中包含多类关联的不大的资源

### 四、数据安全

1、重要接口加权限控制

2、尽量不开放删除资源接口、对于有删除需求的重要数据 后台只做逻辑删除

3、对于需要禁止暴漏自增长id的资源 应生成uuid 按需求设置8-16位

4、考虑事务原子性 保证不意外破坏数据正确性、或造成垃圾数据

### 五、逻辑正确、完整且严谨

基础逻辑必须正确、业务逻辑正确、完整、严谨

产品的业务逻辑在接口中应是完整的 不依赖前端交互而完好运行

接口应有基本完备的参数考验； 不依赖 前端特定传参而正常 ；不会因为前端随意传参 而造成业务逻辑错误。

### 六、明了简洁 逻辑正确 注重性能

可读Python之禅

合理对标准库 及常用库的使用 不重复造轮子

代码块 简单明了、命名 可读+简洁、降低耦合提高复用

逻辑保证正确的基础上 考虑算法性能、接口速度

采用优化算法、优化存储规则、异步执行、增加缓存、精简数据等方式提升代码效率 接口速度

### 七、一些注意事项

#### 分页

列表正常情况都需要分页

- 分页参数
  - page 页码 默认1
  - page_size 每页数据大小
- Header
  - response header 中 X-Pagination 返回分页数据：

```
{'total': 10, 'page': 1, 'page_size': 25, 'previous':null, 'next':null}
```

- 空列表返回的约定
- 根据条件查询为空时 使用200状态码，返回空集合[], 不返回404状态